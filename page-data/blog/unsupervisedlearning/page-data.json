{"componentChunkName":"component---src-templates-blog-template-js","path":"/blog/unsupervisedlearning/","webpackCompilationHash":"0198590be61eebffe261","result":{"data":{"markdownRemark":{"html":"<h1>Unsupervised Learning</h1>\n<br/>\n<p>This blog is the next part of the blog I shared last time, where the basics of supervised learning were discussed. One thing I would love to add this time is some basic pseudocode to the blog so that next time I am doing anything related I can have some reference for the same.</p>\n<p>Supervised learning becomes useful when we have a predefined set of labels on which we want to train our dataset. But, that's always not the case in real-world scenarios. How do we deal with datasets without having specific sets of categories in mind? A dataset containing images with no predefined categories associated would be a good example or maybe a newly discovered heavenly body? Should we call it a Planet (Sorry Pluto) or a dwarf planet or maybe even an asteroid? Such cases are where Unsupervised Learning comes into the picture.</p>\n<p>Clustering a Dataset and evaluating it are the most basic steps. One of the key to selecting the number of clusters for a given dataset is selecting the elbow point in the inertia vs clusters graph. Sci-kit learn provides tremendous support for unsupervised learning in python and one of the basic models include <code class=\"language-text\">KMeans()</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># Import KMeans</span>\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>cluster <span class=\"token keyword\">import</span> KMeans\n\n<span class=\"token comment\"># Create a KMeans instance with 3 clusters: model</span>\nmodel <span class=\"token operator\">=</span> KMeans<span class=\"token punctuation\">(</span>n_clusters <span class=\"token operator\">=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Fit model to points</span>\nmodel<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>points<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Determine the cluster labels of new_points: labels</span>\nlabels <span class=\"token operator\">=</span> model<span class=\"token punctuation\">.</span>predict<span class=\"token punctuation\">(</span>new_points<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Print cluster labels of new_points</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>labels<span class=\"token punctuation\">)</span></code></pre></div>\n<p>One way to categorize data in unsupervised learning is through visualizing the centroids of the cluster. </p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># Import pyplot</span>\n<span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>pyplot <span class=\"token keyword\">as</span> plt\n\n<span class=\"token comment\"># Assign the columns of new_points: xs and ys</span>\nxs <span class=\"token operator\">=</span> new_points<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\nys <span class=\"token operator\">=</span> new_points<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\"># Make a scatter plot of xs and ys, using labels to define the colors</span>\nplt<span class=\"token punctuation\">.</span>scatter<span class=\"token punctuation\">(</span>xs<span class=\"token punctuation\">,</span>ys<span class=\"token punctuation\">,</span>c<span class=\"token operator\">=</span>labels<span class=\"token punctuation\">,</span>alpha<span class=\"token operator\">=</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Assign the cluster centers: centroids</span>\ncentroids <span class=\"token operator\">=</span> model<span class=\"token punctuation\">.</span>cluster_centers_\n\n<span class=\"token comment\"># Assign the columns of centroids: centroids_x, centroids_y</span>\ncentroids_x <span class=\"token operator\">=</span> centroids<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\ncentroids_y <span class=\"token operator\">=</span> centroids<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\"># Make a scatter plot of centroids_x and centroids_y</span>\nplt<span class=\"token punctuation\">.</span>scatter<span class=\"token punctuation\">(</span>centroids_x<span class=\"token punctuation\">,</span>centroids_y<span class=\"token punctuation\">,</span>marker<span class=\"token operator\">=</span><span class=\"token string\">'D'</span><span class=\"token punctuation\">,</span>s<span class=\"token operator\">=</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 572px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/62fd7e922dfd6d65d8b0fa1d2c3be4cc/c8bee/centroids.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 83.91608391608392%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAAsSAAALEgHS3X78AAABtUlEQVQ4y4VT227iMBDN/3/TPq606ksFW+1WSwmUS6A0DcSX+D7jHRNikLjUGo0mcc6cc8Zx0bZsf2Bcqpf5elSuxrMHscz1qFz+WVSF915KqbXeM/5dsFw3LTtwUYQQCBkjPgxKLqKOCDGG9IRAqMIY03Vd/GYRnpAiwj6iimgIrAhMzIS/j3ID8x79G9jf0ZeERwwJTOzk+agE73AeW8DaqmfOf8bwFrFDtEqrM7N3gfDeeoSrLuQWeIQa7TiGzZHoKFsplZmd9RAguHCL35PVCDLi6eMEBkhzs8pu57vd++d6smlrfscCnFxkMDELIZxx1XS7nGz+/ppsZx8wKPchAOJ1rxM4eyba8dN08W+jhUnifRJvg/cAFLfBdMiCC6cdb8Ru8Tkdzb+qpt8nDDNGWLtoD1Rf8p89W2P7Z9l2ou06rvLJVZw9raof5aw8NDYEil7F2XM/bdIJvbyBwIWwk/K1rl+/6q0UaWID+wWztZd/RF7EQ5obpQiJV551njaNjVrQDXPO5dxpne6c1ob2hvf0Zdp1TkhZpL/Ke2rDGE3HcM77mjJnjLQJzvv3ORNZn/8DQ7LZqqc8slAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"Data Centroids\"\n        title=\"\"\n        src=\"/static/62fd7e922dfd6d65d8b0fa1d2c3be4cc/c8bee/centroids.png\"\n        srcset=\"/static/62fd7e922dfd6d65d8b0fa1d2c3be4cc/d4214/centroids.png 150w,\n/static/62fd7e922dfd6d65d8b0fa1d2c3be4cc/135ae/centroids.png 300w,\n/static/62fd7e922dfd6d65d8b0fa1d2c3be4cc/c8bee/centroids.png 572w\"\n        sizes=\"(max-width: 572px) 100vw, 572px\"\n      />\n  </a>\n    </span></p>\n<p>Two other unsupervised learning techniques include hierarchical clustering and t-SNE. The former one results in a tree shaped visualization whereas t-SNE helps visualize data into 2-D space. </p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># Perform the necessary imports</span>\n<span class=\"token keyword\">from</span> scipy<span class=\"token punctuation\">.</span>cluster<span class=\"token punctuation\">.</span>hierarchy <span class=\"token keyword\">import</span> linkage<span class=\"token punctuation\">,</span> dendrogram\n<span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>pyplot <span class=\"token keyword\">as</span> plt\n\n<span class=\"token comment\"># Calculate the linkage: mergings</span>\nmergings <span class=\"token operator\">=</span> linkage<span class=\"token punctuation\">(</span>samples<span class=\"token punctuation\">,</span> method<span class=\"token operator\">=</span><span class=\"token string\">'complete'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Plot the dendrogram, using varieties as labels</span>\ndendrogram<span class=\"token punctuation\">(</span>mergings<span class=\"token punctuation\">,</span>\n           labels<span class=\"token operator\">=</span>varieties<span class=\"token punctuation\">,</span>\n           leaf_rotation<span class=\"token operator\">=</span><span class=\"token number\">90</span><span class=\"token punctuation\">,</span>\n           leaf_font_size<span class=\"token operator\">=</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 559px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/32f7d03faca03297396932dcf6e9c0eb/8727f/heirarchalplot.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 84.25760286225403%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAAsSAAALEgHS3X78AAACCElEQVQ4y31Sa2+jMBDk//+9O6nStYGURwAbP/ETG7trkuaolLvVflgvzM7s2BVCGC+EivVX3UL+bv6Z9x/+ZtNVUkrvnPfeWqu15cIK+SKhb4w9hzGmcs7t+56PUCpTko3NWv9Ia/OyZO/zOUIIldb6CTYmO5dfBoy4f0rpBFZKncFA8jJA1Atm2Pb/zMAJfUqzEKWA4528gNd1/QbvUkVlIkg7gwkpE4EWMmyZ0RzjNxhMSymFPXDLmF6J4quXZ7B8nsrMREXyIT3AYDp0ffR604U97dL9AHPxKPaURQzURLaBghyLbLWmPT3BW9yQQo/fQagQZl4z56AVxMpDsd13A6sCePNbiGExy6xmGCGcYJYprw5SDuIeXlsLuPUAyxB4jIdsY403JhizGWII8LvgkEZF5TSWjQEAplG6xYi3jYTAQqAxUmuLYUSTQQ6wai/6RS/ccqRxdDZTlhEqSPCF0l2pLgTAo2MEhuepjOp538v+yq9v+O2dvLfs81N2cm5zc811nfs+DwNMSQhdnOusHb2vnWuVKvfcTE2Hu3qqP8aPFrUdaj+XdhqatbnKMqdbm2a9XKCoMf6zLA0hV0JGziuwbZ7mYRj6rh+HcbyNcJzGaZ7RtOAJ4wmhGZfiNk1j35e83eZx5JRW8EK44IwxSqmAi9EGXjvjDLyIh6WP2Eq4Z3gPnS9/ts9Ux/WVFQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"Data Heirarchy\"\n        title=\"\"\n        src=\"/static/32f7d03faca03297396932dcf6e9c0eb/8727f/heirarchalplot.png\"\n        srcset=\"/static/32f7d03faca03297396932dcf6e9c0eb/d4214/heirarchalplot.png 150w,\n/static/32f7d03faca03297396932dcf6e9c0eb/135ae/heirarchalplot.png 300w,\n/static/32f7d03faca03297396932dcf6e9c0eb/8727f/heirarchalplot.png 559w\"\n        sizes=\"(max-width: 559px) 100vw, 559px\"\n      />\n  </a>\n    </span></p>\n<p>To improve model performance one can use Principal Component Analysis(PCA) on the dataset. It helps in reducing the number of dimensions of a large dataset. The last thing that I was introduced to was Non-negative matrix factorization (NMF). It is also a dimension-reduction technique but increases the interpretability. One can build a recommender system using NMF. </p>\n<p><a href=\"https://www.datacamp.com/courses/unsupervised-learning-in-python\">Unsupervised Learning with Python : Datacamp</a></p>","frontmatter":{"date":"July 11, 2019","title":"Next Step in Data Science"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/blog/unsupervisedlearning/"}}}