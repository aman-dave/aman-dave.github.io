{"componentChunkName":"component---src-templates-note-template-js","path":"/notes/Microservices/Creating event driven microservices the why how an 79fd2ed806984e5592f3ef9b695e51a0/","webpackCompilationHash":"1307dca3626bbb061791","result":{"data":{"markdownRemark":{"html":"<h1>Creating event-driven microservices: the why, how and what by Andrew Schofield</h1>\n<p>Source: <a href=\"https://www.youtube.com/watch?v=ksRCq0BJef8\">https://www.youtube.com/watch?v=ksRCq0BJef8</a></p>\n<p><strong>Microservices</strong> — is a technique for structuring an application as a collection of services</p>\n<ul>\n<li>Self-contained with clear interfaces and a distinct purpose</li>\n<li>Lossely coupled: communicate over a network</li>\n<li>Independently deployable, scalable, maintainable, and testable</li>\n</ul>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 398px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b06c964f0a6f40726d61e24b0f7e848f/2b173/Untitled.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 72.36180904522614%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsSAAALEgHS3X78AAADHElEQVQozz2SS28bZRSG5/fAqgt+ARI7VCEEEkJILIKCQALBkhaCWkzbqC1KoFxcjNrQRqmTkDRxnUBSnNiO4/gy18zVY489Y8/lm5nvm29uriGq6nbR7dF53vc50iHS/56KitokmUaL4gXlpNmmGI7hRRSlyeTMRRHJ8pKq8VJH6fanc4aXGEE2AYyfnBE+jqRenxJFUpJYWa3TLC2InKzYHgrTiekAmmVpjmtxLCWI9QbZoCiSofu6ESYTwnDcY5SeurFoAMk2eRtQKG7H/6uOh3Ds+N44SewAs6YjGnrV6/IQp0kSBMgLQmLgwbJirOt7RaPE5Vlhv6zsbB0OLNHxcJgAzw/DQNfBD9TKvPDrFyfzOx05DiMI4XNYNe1yvbXZ2n3QLBxtVasPN+n7ufLUbDAM43QKRzgYwjAriwu1gyVKLTnTtAAi5AcRoblwqUk+vPro6I+8OJ/JKvmb3N3V2injwChKgA9jjKc7i+aTn/HTBRRvjoIYv4SBf6WPvzxkL6ztXl7evrCx9fm/xxk9bVt+9EJ7HKIeiGY6B28oa6+L93KaM8EBgvA5bLrweGAWu1aO7uYFvaiM/lGtmm4PHDeIUsvzAQpkL/iGaswcVj6uSKuaC9KxDV802x6sefjPbnRLsG8b/soQ3bHTkp8OXD+MEt5y20ObFbqnrMmBULZcSVLIBkl52IWYcFz/Jx3NmtVPuM7VvPyZaF/b2PneiFTgJ/G4ZRibN7bK2Z216w+2+6PS4gL53delzLcVbeTjmLBceKMfvNXbf48fzG4PZ2hn7m5hToWyA+MwadnwtwqbOzhaUtSiiVfqzNLeYU4DJRtP34AYQXSJARdv994taxeXi+f1znnQ/lCaSI6XxknVcDPgbLE/zjXde303451dG4b39482rAihkOjb4FPSPLcuvVbg38z+/cpB+9XH++9QwfTUFOHCEMwusx/MV97+pX5Tgx/tkpe+uvz+rdWs6noeJDoDY4OVV/nOMq3c4Qcr7c4a2fuLkxlVA8A/lnvZUuv63smPbfERr/7+uLawXpxrKIVTeWQ5zwBk9Ksh0yLY+QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"Monolithic vs Microservices\"\n        title=\"\"\n        src=\"/static/b06c964f0a6f40726d61e24b0f7e848f/2b173/Untitled.png\"\n        srcset=\"/static/b06c964f0a6f40726d61e24b0f7e848f/d4214/Untitled.png 150w,\n/static/b06c964f0a6f40726d61e24b0f7e848f/135ae/Untitled.png 300w,\n/static/b06c964f0a6f40726d61e24b0f7e848f/2b173/Untitled.png 398w\"\n        sizes=\"(max-width: 398px) 100vw, 398px\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Monolithic vs Microservices</figcaption>\n  </figure></p>\n<p>⇒ Generally, people tend to create REST interfaces for communication of data. This is undesirable as — it will increase latency as long call chains are created, potentially long latency as you go from one microservice to another, and worse — the system will break if one of the services is down for maintenance.</p>\n<h2>Event-driven systems</h2>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 571px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/551c8cbf3f434ceb8b8e37ed8d5ab8c5/0b5d2/Untitled%201.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70.05253940455341%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsSAAALEgHS3X78AAACqElEQVQozy2SSYvUUBDH8w08evFDePYmInjQiyjCnD34CTwqgojMRdxAUBBkRAZHR2b0NC44OqAy3e10Z+slnc7eWV/yliQv3em20iMU4b36p+pV/aoEkvOCz1hZpbTMSJ5gFpMCzo2xkhYVqPBtriSPcZ6Q/L9KS8EMsqefWnsdnZbzcL5MZ8uEFFnO5/WyrOqBEz/cOfylOrSqgxrURYwLUlTzxTJjXDgcumvrO4922ykt9I+bdvsP4gvNjb8eGbSYfesaV+5tv95XszTT3r9yVQnxWjHCH5KFaCHgnHe16YQu9I0nnTMneldPY8968Vm8dOftd9His7o1cC1ajx7fAlW9cSFF6fq739fub7c1X4DSWV5mi6X5YaN7/pR8/Vw8nbb08M2+YkeUljNQ0Wypv3zw9+zJ/s01lNEDxdk66PuINcFACDrJ+Az1e4HjonLBoKt6CY0jyhuVlLjksdQJgijjdV42KlAUoO+UcgB7pPnP9iTZAZw8wgUC+HmF8wqt1J+S9fyLPAkJZk26lPEGWMZgJBxSbe7LF29vAnZACenwKhIsYxVgf7x7ePnuVkebQk2Qa+VfBcMLQN9Pi9bIhwoBMgFrnM0B/mPl3ApJWwvgTFeerHm5bIJx3txhB0o+DxPcUwfKaOyFyE9ImOYTNwSPPBgmKYZxJhhWhcFSwJiaUQFSL4gkddCVVXWodSWlK8m2H7sJmSKqu5Go9EW1D6qoqMpgJPUHzhReyQXYJyfC4shUxpakNSYODXFoejGeJjRAzPSRPLZ7QxMkWbOUsa3qTm9oRCkV4ozZIbbCzI6xFRErxDZ8IwzDO7YwZeAxghQkJyJmgHQvHrsRFC8AepjYsQEkP0pM27Ndf2K5Y9OZWJ5uuYbtGbZjOh5ZoYkzEqcY4fwfaJHq3o/Q5NkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"Comparing Data Movement\"\n        title=\"\"\n        src=\"/static/551c8cbf3f434ceb8b8e37ed8d5ab8c5/0b5d2/Untitled%201.png\"\n        srcset=\"/static/551c8cbf3f434ceb8b8e37ed8d5ab8c5/d4214/Untitled%201.png 150w,\n/static/551c8cbf3f434ceb8b8e37ed8d5ab8c5/135ae/Untitled%201.png 300w,\n/static/551c8cbf3f434ceb8b8e37ed8d5ab8c5/0b5d2/Untitled%201.png 571w\"\n        sizes=\"(max-width: 571px) 100vw, 571px\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Comparing Data Movement</figcaption>\n  </figure></p>\n<h3>Event-driven microservices</h3>\n<ul>\n<li>\n<p>Microservices communicate primarily with events, with APIs where required</p>\n</li>\n<li>\n<p>Microservice can produce and consume using pub/sub system</p>\n</li>\n<li>\n<p>Events are handled by event backbone</p>\n</li>\n<li>\n<p>Data is eventually consistent</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 600px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4b8133d36d94d09dfbbb1734b345f444/57e09/evt-micro.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 87.04663212435234%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAABcSAAAXEgFnn9JSAAAEWUlEQVQ4y3VTDUxTVxR+oHQUN0RhOlwAGYpAhLmNLARBmLBNIrJsmcxggCgWEDsomSUaJWxiuwmDViyMSh2haJAC3UCDpfTRUvqHUqCA0CIwMkpncfI7KL+evVcKMpKd5Mu9557vfO+8e85FEMyWGh8egHZVBLQpwqFN/imolZ+BrOko8O/aIZuMxWLt0Wg02UKhUCYQCLokmLW3t1/Kysp6zV0QC2vnFC0wIRYtTTajKxMSdGVJIYXJ2qrjCGJHpKalukZHR+/39/f3YjKZZEwA6urqoL6+HkQiEahUKuBwOL7rgqay2y1L98vAUFwAYyWFYMQA/Apoy/uRirzr4UDPoDo6OTl9jFGP4Pz079K9aXRaKquwMPM6jXYhNj7OCz9HBaJVQcjPPmZi0HNf/pydM557LeeffBp97kbWFTn5nHtQTKzj2bhYt7CwMJ/IyEjvpLOJH1ghyM7NV9Ex0W1Fbv0JQd4kEndhvgeG3RviNpsTAMDKXN21jIjzWWkXUpjUABn07Hs0pfSsfo7uXSdaWVs7byMQDlHJ5INY0hsYtoBCuTXv6lWnFBLJ0ZZIdMNovh5ue3fgfOW8ht9h6oXWyU6TaqJ9uXW8Y/HJfA8IxuXpGwuw/uJ4xElsJW48JJFIhJPR0S7BIcGOvQVcc4W/TTWq+X89gtKeiiWulgdlvZUrApMUGmcVuh2ZQQRzIhtte+9KQUkihXknXDILPlIT+NQbX3mtCX9LoWy/mEk139uNkZKLnLkauD3FA/Z4JZRMV0Hp4u9w52V1B5LsstWcIDIuPlCNL4P0+dyCxDADktFpUExijf5j5vqaaHjUMUJS3Dn8vm0oXfRAylNaSHxN2olITuyJmNLk+NTm7wPWf43754K8RKOHAnnfIkvVv3xLqV28NzwL97R/G0+dinGWikUEvCkYkOTkJAcshTBfPPJWKYPzOZ3yQyDm77E0blXwsvpFBsMAwNBbMAJwawxb++f0UV+dsXPevcvd1+99z4CAgH1+h/y2o02oqFPTCYIGAcjkMtDqtEZ+Lf+T/4xFimTo6NfioSORDbrDOL4UDYQENgx64zFbO6KrpYq3gw4HEblc7i9sNnu0qKjoBYYxHo+nLi8v/9AsVMLXvH6Cj/Ux0D99HnRTiRhIr3STqaOt+jNrcWY+055MJttbXNuEhAT30NDQd9bizc3NVsjTmg7zOMjK1O6GTgMMq4dB36mHkY4RMHQbYFI7AWiZKP/0N6d3Ojg4+GDUg0Qi8YCrq6vNxqGnUCjWZkdRLDMLNtKELrqHffCYp1pRVihMqvvKhbaqJ/MDDf0Lw+IhGGoaDMV5uZdybOzt7a2R/7OqyzwEZla7I85DabpKLQzxB2Gw5hkMVD8DLa8PxpqM0F3TFWUeMbZwiyXVH8NHeMUY/Cz7beZIafKv6x94kF2XIWai1ShDxG1ioOViZtPdFpa0HM1t3I/Hb6Yw1qrDBx0fmRAMwRg88Zf8L1QUP6Mxdz2uAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"Event Driven Microservices\"\n        title=\"\"\n        src=\"/static/4b8133d36d94d09dfbbb1734b345f444/34e8a/evt-micro.png\"\n        srcset=\"/static/4b8133d36d94d09dfbbb1734b345f444/d4214/evt-micro.png 150w,\n/static/4b8133d36d94d09dfbbb1734b345f444/135ae/evt-micro.png 300w,\n/static/4b8133d36d94d09dfbbb1734b345f444/34e8a/evt-micro.png 600w,\n/static/4b8133d36d94d09dfbbb1734b345f444/57e09/evt-micro.png 772w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Event Driven Microservices</figcaption>\n  </figure></p>\n<h3>Messaging Patterns</h3>\n<ol>\n<li>\n<p><em>Point-to-Point</em></p>\n<ul>\n<li>Producer — sends the message</li>\n<li>Consumer — recieves the message</li>\n<li>Each message is consumed by a single consumer</li>\n<li>Queue is used as an intermediate structure, it is a good way of sharing messages to one person but not a good way of spreading to multiple processes</li>\n</ul>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 373px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6f658f1383ccf02361761b145bc4344f/f9f05/Untitled%202.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 79.62466487935657%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAAsSAAALEgHS3X78AAACs0lEQVQoz2VSXY+bOBTN/3/cv7CPK+2u1Ieqna/MBBICKQkQmBBCwISPAAaDje2QzGxrkrar7UpHlm3d43PuPR5hdr6iF2tLe9q/qyv745OkLNe67UoLY/rFvJsoE21VY0745Uf9gNGN9hOE9wjTEuGqpS091YSKTdkQ2HQd/0/ljTzItqzvTue85sqqNF5r022WTuUB4gZk6dTmBpkumhsQNpz8T7m/Gj7HBX2c5VO9UFbwiw2Xr0g1K8GRF8XSrsfzErYnodHSX20Pa4VP3oF6ERurtbysg4RmFQ8SZmzxk1qZWxwXDAuZ0+XG/7dnws/8fLm8X97+eTtdLkfIwqTbHYgfk31CbL9VzEp/beZmnUF243/vWTCFpSBjfsL26QBw5Ifi5Md0F4knun1Mg5RaHlateqyWos2fA+Os702vNbdINpBmN1OjkpaValWrTbNYV5pVieY1CxkbcQnnFvpue6qXs1Up68XKbbw9sP3CA9DxM8fPXT/dg2K7z9bbxPEye5unOXyYpmHG2Plqu0S8bESevbVrN6Cb20R3O83BqoP1DTZcrDuNGJVwu1i3wvZ619Bh4FfboluBjp9R108NpG8afdNuwu6PT5kTdELkk1Q8zgtZh7sDnZl1mHb0R1qj6xtDziLAMBVTbWDLvaidrSpE+vev75aH/roXVqlIwQVYePzlhw3o394KxO5nuRu2ScnET3JDcsi7R+VYNNwFXXBNTpQNyjcyIqwhHLbMi7Bm1b/9Hoj20pIGCXnRoDgqZn2s6D7Gfz9kf37OvIgIg23HasJHeYVhQ4IUfRyHzwr4PAnlRfThATxOwbMSPcjReBbeyeG9HF+P4E4KpUVW1G1R49HhWIoA/KgQ1ZIGJlo40cCLFk2GfSRph7ESzpbgWY1eVCAtwJMSqEac5DA+wm9921xDEzKZgwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"Point to Point\"\n        title=\"\"\n        src=\"/static/6f658f1383ccf02361761b145bc4344f/f9f05/Untitled%202.png\"\n        srcset=\"/static/6f658f1383ccf02361761b145bc4344f/d4214/Untitled%202.png 150w,\n/static/6f658f1383ccf02361761b145bc4344f/135ae/Untitled%202.png 300w,\n/static/6f658f1383ccf02361761b145bc4344f/f9f05/Untitled%202.png 373w\"\n        sizes=\"(max-width: 373px) 100vw, 373px\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Point to Point</figcaption>\n  </figure></p>\n</li>\n<li>\n<p><em>Publish/Subscribe</em></p>\n<ul>\n<li>Topic is used as an intermediate structure, where you could have multiple subscriptions to each topic, each subscription gets its own copy.</li>\n<li>Good way of <em>faning-out</em> information</li>\n</ul>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 390px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b83e8b84c8f37caca512f4e2b8a2e0ea/14f69/Untitled%203.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 101.28205128205127%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsSAAALEgHS3X78AAADaUlEQVQ4y1WS2W/bRhDG+f8Dfeh7gaBo0SKtESU6rEhxbUeWrEgkl5dEive14inxJrUU/ZC1jfoAPiyGw/nttzuzRNGcX1SeOnsfs6Iq6bZkOKrt8Tt9o1h4BVvFhGGFHoqmfdJjPfEWrk4dDGNKEAVFFzVjq5pgs+NllZc1nDSg9wS/1LfEG9tzUiLbr/cxgiEOmrzuwqSF4WkfIRihMEFvnV7hvD43bWfA8vsquKOiFRdP577mFjMyvMUZMlyC+J6Jnytf+HfOcYZEvRTU8mZ1XAmpd2iMfSXb1T2broVMcytcVqPufwS9u3Nz7k5ddzp3cXZSnUpzKtOrTa+SzfIeJGshYeXcDesaPfu/uXNWtUGC/CPCa5S1cdZ6B2TsayzLa5ygUZyKkbPpIoZRU7cd5gl82gp17cMDNlny6T2XrjYZuc3mTLbkEnqbknzCSgkn5yvuyO3S2zWG6ye4Jcx9MQcxkJKdXdEbWzZC1Y4UKxC1g6R5WKLsa6YvG4FmhoLk39FJ3Z6fR02kZRulKC3PGqxpqcC2tJxv9IqWSlrKGTFlpGyrFdiZ2qSslGFb3Jq8Ro93fj529dRD0SjnzPF6FY++B5cz/+simCyC8cwb3/k362gODjurfNNg9Dpn/LyitNnHFYwKXj5O5vuPl/bHSwfDrHyEYQmjMs4b/ISfW/1uzviR4AmRm2hwaw9unSUbqW6hueUP/ji48bAWTIR3b86vL5RIiiYtmzirRD0V1OzX3/Xf/rVwXCFUNqeyQeUJqU72xxf3lw86tU22WhYmFUYwSASH/JAVqnW4WVorxgEbbwlsVgqOebGPUi/KDmlOCj7FuWvWpQU4nRmqfcBIcMgIx4tcP7JgyIiQ3sDeVPtypa851wtjL4phEONANnywgXPKuiMtVoSGE2LE8QJCtyCWYcOtbJOcMfpPogXzbq0Pr6RvM4XmTSCYO83Zytb1vXK9kHeqrZmObrlYhKjqim6SnPJ5zPQuwcWQ+adPj674iwH46xP4NGL6E+bPC9CfsBdD0Buzf/doilMU3ZBUneC2O17ckaw4nILBBIyuQO+SGl+z/a94i8fMcEr3J2AwBcNv+C/zeQwoVhTEHQYJiuGxaPZxJRmBBDgQaFagWPz5GOMkwwk4WFHsbLFe/CAXy/WKYnD9T8VIHJTjFuJXAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"Pub Sub Model\"\n        title=\"\"\n        src=\"/static/b83e8b84c8f37caca512f4e2b8a2e0ea/14f69/Untitled%203.png\"\n        srcset=\"/static/b83e8b84c8f37caca512f4e2b8a2e0ea/d4214/Untitled%203.png 150w,\n/static/b83e8b84c8f37caca512f4e2b8a2e0ea/135ae/Untitled%203.png 300w,\n/static/b83e8b84c8f37caca512f4e2b8a2e0ea/14f69/Untitled%203.png 390w\"\n        sizes=\"(max-width: 390px) 100vw, 390px\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Pub Sub Model</figcaption>\n  </figure></p>\n</li>\n</ol>\n</li>\n</ul>\n<h2>Apache Kafka</h2>\n<ul>\n<li><strong>Publish/Subscribe:</strong> Provides pub/sub model at great scale</li>\n<li><strong>Process:</strong> Great support for stream process</li>\n<li><strong>Storage:</strong> Strong storage infrastructure</li>\n<li>Kafka expects to have a lot of data behind it, it doesn't know anything about it, position about the applications are stored and not the indexes, and this makes it cheap.</li>\n</ul>\n<h2>Event backbone</h2>\n<ul>\n<li>A producer microservice publishes an event on to the event backbone and a subscription microservice consumes it.</li>\n<li>All these happens asynchronously</li>\n<li>Huge benefit — you could kill a microservice or keep it in maintanance without hindering the system</li>\n</ul>\n<p>A more complex event-driven example</p>\n<ol>\n<li><a href=\"https://ibm-cloud-architecture.github.io/refarch-kc/design/readme/\">https://ibm-cloud-architecture.github.io/refarch-kc/design/readme/</a></li>\n</ol>\n<h2>Patterns for event-driven microservices</h2>\n<p>We need:</p>\n<ul>\n<li>Loose Coupling</li>\n<li>Data Consistency</li>\n<li>Efficient Queries</li>\n</ul>\n<h3>Patterns</h3>\n<ol>\n<li>\n<p><strong>Database per service:</strong> each microservice persists its own data</p>\n<ul>\n<li>Introduces complexity to sync data across databases</li>\n<li>Kafka log compaction helps to do this</li>\n</ul>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 600px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/639bc5a45fb4eaee39e80340308d69e8/ba6d6/Untitled%204.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30.822510822510825%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsSAAALEgHS3X78AAABaUlEQVQY0yXLzUvCYACA8f2pEZF0qKhzRBSBHjx5kOpkUFlUhE5TI3F7ddOpax9qls7p5ua219R9+TGNCoKH3+1BDs9Ku0EsBsTl0pNvg73QtoE/2asfy51bU+8/e7YkilQcRSm65pqCzazbzJpllJHQHe+PVA7CRe3LGqYj6tWpHN4zddXxfuzpwp79nZ67WDEcjwE8kcooPWYhHDn81oj2Ic7ME1WzVBv0NBs635qqqw1eH0DDXMDJfPjneGaMp/rIVQxLlA1Jm8CxbUBtpNGIIMFWF9Y/B7IylAeTbksUO1IfTusf3QLF4gRda4p9zWy25U5PVw1HVqAk8h1p3FFchHvvhm+Ke4HkyTneajTZi+NKcF9IX2cTjH8zEvBdFrN8DoBo9D6OZsR2TcB3hNzGJ3XONhWkwjaS2beHZyr2UiUpLv/yClJpAicxwMUfCfSJBASXy1czWfIVK5NljiykyDwKAFai67+L4STa1lLgGgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"Patterns: Database per service\"\n        title=\"\"\n        src=\"/static/639bc5a45fb4eaee39e80340308d69e8/34e8a/Untitled%204.png\"\n        srcset=\"/static/639bc5a45fb4eaee39e80340308d69e8/d4214/Untitled%204.png 150w,\n/static/639bc5a45fb4eaee39e80340308d69e8/135ae/Untitled%204.png 300w,\n/static/639bc5a45fb4eaee39e80340308d69e8/34e8a/Untitled%204.png 600w,\n/static/639bc5a45fb4eaee39e80340308d69e8/fea0e/Untitled%204.png 900w,\n/static/639bc5a45fb4eaee39e80340308d69e8/ba6d6/Untitled%204.png 1155w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Patterns: Database per service</figcaption>\n  </figure></p>\n</li>\n<li>\n<p><strong>Sagas:</strong> orchestration of multi-step operations across microservice</p>\n<ul>\n<li>Eventually consistent</li>\n</ul>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 600px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d3d34a4e54cc5fe7b1f4136e4ad35dce/76d12/Untitled%205.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.005818786367414%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsSAAALEgHS3X78AAABRUlEQVQY0y3Gy07CQABA0X6piTvjD7h1J2ujK40xrkxcIBhZaDTxhWAUKW2BtrYF+pgZ5tGZzrQlgkZrTE5urqaKwhyNHtpP5kdAbT2u74HWERcSsgyn/4RSzTundvx8eu0y4hBzm493ZOppcNrvdB7PG/WubqC3u2h3MzncEpTOKUuznPAcsVzki5OWvVG7P7gIShmUxnoxWJPU1ELfYtknYoqKErAczlOQIBADlECaZiHOZxDHMI5h+ItziDCAKITzOS9W2sQ1QqAwk4SXfxZMLqdQ+EPLfem19YBHt94k4kIJWaQi94LQGrl9wwuh0HzHSKAimMUxgoCABGNELdsf3Fz2mo2zq15i7Hdf9UwtVb6qFKui/BJymZBCm/nv7si0hwPbGlStRnfHhusMncCPkwBTQuU35iVOFxW+QKyMoCBc/QAxYznkpyhckQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"Patterns: Sagas\"\n        title=\"\"\n        src=\"/static/d3d34a4e54cc5fe7b1f4136e4ad35dce/34e8a/Untitled%205.png\"\n        srcset=\"/static/d3d34a4e54cc5fe7b1f4136e4ad35dce/d4214/Untitled%205.png 150w,\n/static/d3d34a4e54cc5fe7b1f4136e4ad35dce/135ae/Untitled%205.png 300w,\n/static/d3d34a4e54cc5fe7b1f4136e4ad35dce/34e8a/Untitled%205.png 600w,\n/static/d3d34a4e54cc5fe7b1f4136e4ad35dce/fea0e/Untitled%205.png 900w,\n/static/d3d34a4e54cc5fe7b1f4136e4ad35dce/6ff5e/Untitled%205.png 1200w,\n/static/d3d34a4e54cc5fe7b1f4136e4ad35dce/76d12/Untitled%205.png 1203w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Patterns: Sagas</figcaption>\n  </figure></p>\n</li>\n<li>\n<p><strong>Event Sourcing:</strong> every change to one of the objects becomes an event, by writing into the event backbone</p>\n<ul>\n<li>To achieve atomicity — publishing an event is an atomic event</li>\n<li>Kafka event sourcing can handle this</li>\n</ul>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 600px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/aaa9ad0fd27bed205bb7bf0eec1ee59b/ab984/Untitled%206.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33.89830508474576%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsSAAALEgHS3X78AAABT0lEQVQY01WQ207CQBCG+/Y+iTdeGIwkSmJC1EAhFClyRhBpS7fHPbbd7XahLkQTTf7MTGa+5J8ZA6I0TGkQkjCmNC9ZUTFeMVGRrPwnPeJVgrMwJZAVuTzqptFpXjVa3YW1WU0+QYD9A95v491HTAtNyx+JClEOAHLcaDn1rJfZ4MnOpTJ2X7u9jzwAPYDCJPd9ullEM8tNCcesRLTETEAqHAeBkHkAB0lmm5vew4yrowGpSnAZIy2RktL1M2sUmubhfQWnazRZQ104IHddHKXc8ZE92drz7XjlxFgYdV2fTvUlnlOQ5I3WqNme39wP7lrjx/b79W1/vgQy40pp4KgqoSQnhLlRZkAstW1ydi517fh5Z+h334LXwcEcgt4IPPe95RZDDcAzBkmFmYqgjBA39Kp/hZj+k7o8XFFe0UJlQqFMJr8ApFKf7QIESfEN4fx/CCUgIHkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"Patterns: Event Sourcing\"\n        title=\"\"\n        src=\"/static/aaa9ad0fd27bed205bb7bf0eec1ee59b/34e8a/Untitled%206.png\"\n        srcset=\"/static/aaa9ad0fd27bed205bb7bf0eec1ee59b/d4214/Untitled%206.png 150w,\n/static/aaa9ad0fd27bed205bb7bf0eec1ee59b/135ae/Untitled%206.png 300w,\n/static/aaa9ad0fd27bed205bb7bf0eec1ee59b/34e8a/Untitled%206.png 600w,\n/static/aaa9ad0fd27bed205bb7bf0eec1ee59b/fea0e/Untitled%206.png 900w,\n/static/aaa9ad0fd27bed205bb7bf0eec1ee59b/ab984/Untitled%206.png 1121w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Patterns: Event Sourcing</figcaption>\n  </figure></p>\n</li>\n<li>\n<p><strong>Command Query Responsibility Segregation (CQRS):</strong> atomic writes and efficient reads at the same time</p>\n<ul>\n<li>Complicated to achieve in practice</li>\n<li>Write/Update/Delete is on different store than Read store</li>\n</ul>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 600px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8d2e4a1f05065fd42c6a542446690a5a/c0260/Untitled%207.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33.97887323943662%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsSAAALEgHS3X78AAABYUlEQVQY0y2PvU/CQBiH+0+6ueHg6OaCixLj4sxm4uCkE4mkIUCUKAgEEjSCsUDpB5R+nO1d76tHa70Gkydv7vI+v/fuVSBJIE0wTydTbfqtB5BAKiKcFJA9Yvwxm2qmFxHMd4VPBKIFShhzHzLbj0+unw/P6pWbERNphLmUZB4zYXtxqdI6OH28uh0DRN2QyNZ/2I9IufpSOm+Uq72H9rw5tGVYNmJWgLkAiKl96079Or5sHV0079tanuc4KRzF9sjTaF3rrGY62AIaxskP4hEWISpelleIRUx3yw0cTl21q/ffzbnhLS25n1AYT9NMzsrlwXCQVLsTR+2acqLaM1sDq/FmmU688XGW5ZRyfWUvlsbk0/AjpmC5PRbFeCJcQD1AWwNbfqTRt2odQ+brr6ZmwhBxVDg7mvyKNA+iHUCJ4gTcAf+4YSJBNMUs29eYZrICKLZ7J2AOYKt1tDADF6A/Ycl1+6NljtYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"Patterns: Atomic writes\"\n        title=\"\"\n        src=\"/static/8d2e4a1f05065fd42c6a542446690a5a/34e8a/Untitled%207.png\"\n        srcset=\"/static/8d2e4a1f05065fd42c6a542446690a5a/d4214/Untitled%207.png 150w,\n/static/8d2e4a1f05065fd42c6a542446690a5a/135ae/Untitled%207.png 300w,\n/static/8d2e4a1f05065fd42c6a542446690a5a/34e8a/Untitled%207.png 600w,\n/static/8d2e4a1f05065fd42c6a542446690a5a/fea0e/Untitled%207.png 900w,\n/static/8d2e4a1f05065fd42c6a542446690a5a/c0260/Untitled%207.png 1136w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Patterns: Atomic writes</figcaption>\n  </figure></p>\n</li>\n</ol>","frontmatter":{"date":"May 14, 2020","title":"Creating event-driven microservices"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/notes/Microservices/Creating event driven microservices the why how an 79fd2ed806984e5592f3ef9b695e51a0/"}}}